// Changes:
//	- Prevent players from simply waiting outside of last reaction and delaying
//	- Make the map not use sourcemod commands
//	- Make pushes not get players stuck in the ground in smokegrenade minigame
//	- Make the grenades reliably kill the other team in smokegrenade minigame
//	- Reduce wait time on triggers to ensure players get a smoke grenade when they go through the doorway in smokegrenade minigame

// Prevent players from simply waiting outside of last reaction and delaying
add:
{
	"classname"  "trigger_hurt"
	"targetname" "reactiongame_afk_killer"
	"origin" "2184 1308 176"
	"StartDisabled" "1"
	"spawnflags" "1"
	"nodmgforce" "0"
	"damagetype" "0"
	"damagemodel" "0"
	"damagecap" "999999"
	"damage" "999999"
	"vscripts" "ice/tools.nut"
}

modify:
{
	match:
	{
		"classname" "logic_relay"
		"targetname" "reactiongame_start"
	}
	insert:
	{
		"OnTrigger" "reactiongame_afk_killer,Enable,,15,1"
	}
}

modify:
{
	match:
	{
		"classname" "logic_auto"
		"origin" "168 -936 24"
	}
	insert:
	{
		"OnMapSpawn" "reactiongame_afk_killerRunScriptCodeResizeTrigger(1136,152,320)01"
	}
}

// Make the map not use sourcemod commands
modify:
{
	match:
	{
		"classname" "logic_auto"
		"targetname" "168 -936 24"
	}
	delete:
	{
		"OnMapSpawn" "serverCommandsm_cvar cs_enable_player_physics_box 10-1"
	}
	insert:
	{
		"OnMapSpawn" "server,Command,cs_enable_player_physics_box 1,0,-1"
	}
}

modify:
{
	match:
	{
		"classname" "math_counter"
		"targetname" "chair_knife_counter_ct"
	}
	delete:
	{
		"OnHitMax" "serverCommandsm_csay Counter-Terrorists win.1.1-1"
		"OnHitMax" "serverCommandsm_say Counter-Terrorists win.1.2-1"
	}
	insert:
	{
		"OnHitMax" "server,Command,say Counter-Terrorists Win,1.2,-1"
	}
}

modify:
{
	match:
	{
		"classname" "math_counter"
		"targetname" "chair_knife_counter_t"
	}
	delete:
	{
		"OnHitMax" "serverCommandsm_csay Terrorists win.1.1-1"
		"OnHitMax" "serverCommandsm_say Terrorists win.1.2-1"
	}
	insert:
	{
		"OnHitMax" "server,Command,say Terrorists Win,1.2,-1"
	}
}

modify:
{
	match:
	{
		"classname" "func_button"
		"targetname" "buttons_elevator"
	}
	delete:
	{
		"OnPressed" "serverCommandsm_cvar cs_enable_player_physics_box 00-1"
	}
	insert:
	{
		"OnPressed" "server,Command,cs_enable_player_physics_box 0,0,-1"
	}
}

// Make the grenades reliably kill the other team in smokegrenade minigame
filter:
{
	"classname" "trigger_multiple"
	"origin" "-80 1936 200"
}

add:
{
	"classname" "trigger_multiple"
	"targetname" "dodgeball_smokegrenade_trigger_ct"
	"origin" "-88 1944 248"
	"wait" "0.08"
	"StartDisabled" "0"
	"spawnflags" "1100"
	"filtername" "smokegrenade_filter_multi_ct"
	"vscripts" "ice/tools.nut"
	"OnStartTouch" "dodgeball_hurt_ts_temp,ForceSpawn,,0,-1"
	"OnStartTouch" "dodgeball_hurt_ts_trigger,SetParent,!activator,0.02,-1"
	"OnStartTouch" "dodgeball_hurt_ts_triggerRunScriptCodeself.SetOrigin(activator.GetOrigin());0.02-1"
	"OnStartTouch" "dodgeball_hurt_ts_triggerRunScriptCodeself.SetAngles(activator.GetAngles().x,activator.GetAngles().y,activator.GetAngles().z);0.02-1"
	"OnStartTouch" "dodgeball_hurt_ts_trigger,SetParentAttachment,center,0.04,-1"
	"OnStartTouch" "dodgeball_hurt_ts_trigger,AddOutput,targetname blank,0.06,-1"
}

add:
{
	"classname" "trigger_multiple"
	"targetname" "dodgeball_smokegrenade_trigger_t"
	"origin" "-88 1944 248"
	"wait" "0.08"
	"StartDisabled" "0"
	"spawnflags" "1100"
	"filtername" "smokegrenade_filter_multi_t"
	"vscripts" "ice/tools.nut"
	"OnStartTouch" "dodgeball_hurt_cts_temp,ForceSpawn,,0,-1"
	"OnStartTouch" "dodgeball_hurt_cts_trigger,SetParent,!activator,0.02,-1"
	"OnStartTouch" "dodgeball_hurt_cts_triggerRunScriptCodeself.SetOrigin(activator.GetOrigin());0.02-1"
	"OnStartTouch" "dodgeball_hurt_cts_triggerRunScriptCodeself.SetAngles(activator.GetAngles().x,activator.GetAngles().y,activator.GetAngles().z);0.02-1"
	"OnStartTouch" "dodgeball_hurt_cts_trigger,SetParentAttachment,center,0.04,-1"
	"OnStartTouch" "dodgeball_hurt_cts_trigger,AddOutput,targetname blank,0.06,-1"
}

modify:
{
	match:
	{
		"classname" "logic_auto"
		"origin" "168 -936 24"
	}
	insert:
	{
		"OnMapSpawn" "dodgeball_smokegrenade_trigger_*RunScriptCodeResizeTrigger(1808,1808,464)01"
	}
}

add:
{
	"classname" "point_template"
	"targetname" "dodgeball_hurt_cts_temp"
	"origin" "-88 1944 248"
	"spawnflags" "2"
	"Template01" "dodgeball_hurt_cts_trigger"
	"OnEntitySpawned" "dodgeball_hurt_cts_triggerRunScriptCodeResizeTrigger(4,4,8)0-1"
}

add:
{
	"classname" "point_template"
	"targetname" "dodgeball_hurt_ts_temp"
	"origin" "-88 1944 248"
	"spawnflags" "2"
	"Template01" "dodgeball_hurt_ts_trigger"
	"OnEntitySpawned" "dodgeball_hurt_ts_triggerRunScriptCodeResizeTrigger(4,4,8)0-1"
}

add:
{
	"classname" "trigger_hurt"
	"targetname" "dodgeball_hurt_cts_trigger"
	"origin" "-88 1944 248"
	"spawnflags" "4099"
	"StartDisabled" "0"
	"filtername" "filter_ct"
	"damage" "10"
	"damagecap" "20"
	"damagemodel" "0"
	"damagetype" "1024"
	"nodmgforce" "0"
	"vscripts" "ice/tools.nut"
}

add:
{
	"classname" "trigger_hurt"
	"targetname" "dodgeball_hurt_ts_trigger"
	"origin" "-88 1944 248"
	"spawnflags" "4099"
	"StartDisabled" "0"
	"filtername" "filter_t"
	"damage" "10"
	"damagecap" "20"
	"damagemodel" "0"
	"damagetype" "1024"
	"nodmgforce" "0"
	"vscripts" "ice/tools.nut"
}

add:
{
	"classname" "filter_activator_class"
	"targetname" "smokegrenade_filter"
	"origin" "-88 1944 248"
	"Negated" "Allow entities that match criteria"
	"filterclass" "smokegrenade_projectile"
}

add:
{
	"classname" "filter_multi"
	"targetname" "smokegrenade_filter_multi_ct"
	"origin" "-88 1944 248"
	"Negated" "0"
	"filtertype" "0"
	"Filter01" "filter_ct"
	"Filter02" "smokegrenade_filter"
}

add:
{
	"classname" "filter_multi"
	"targetname" "smokegrenade_filter_multi_t"
	"origin" "-88 1944 248"
	"Negated" "0"
	"filtertype" "0"
	"Filter01" "filter_t"
	"Filter02" "smokegrenade_filter"
}

// Reduce wait time on triggers to ensure players get a smoke grenade when they go through the doorway in smokegrenade minigame
modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"origin" "536 1952 80"
	}
	replace:
	{
		"wait" "0.02"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"origin" "440 1952 80"
	}
	replace:
	{
		"wait" "0.02"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"origin" "-744 1952 80"
	}
	replace:
	{
		"wait" "0.02"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"origin" "-648 1952 80"
	}
	replace:
	{
		"wait" "0.02"
	}
}